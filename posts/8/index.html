
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Larry Price</title>
  <meta name="author" content="Larry Price">

  
  <meta name="description" content="Need to parse an XML file in go? XML (en|de)coding is build into go&rsquo;s standard library. Basic parsing of nodes and embedded nodes is &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://larry-price.com/posts/8">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Larry Price" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='https://fonts.googleapis.com/css?family=Montserrat+Alternates|Marcellus' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35669093-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner" style="background:url(/images/coffee-stain.png) top right no-repeat; background-size: auto 100%;"><hgroup>
  <h1><a href="/">Larry Price</a></h1>
  
    <h2>And The Endless Cup Of Coffee</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:larry-price.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/books">Books</a></li>
  <li><a href="/blog/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/12/04/xml-parsing-in-go/">XML Parsing in Go</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-04T15:30:14-05:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:30 pm</span></time>
        
           | <a href="/blog/2015/12/04/xml-parsing-in-go/#disqus_thread"
             data-disqus-identifier="https://larry-price.com/blog/2015/12/04/xml-parsing-in-go/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Need to parse an XML file in go? XML (en|de)coding is build into go&rsquo;s standard library. Basic parsing of nodes and embedded nodes is straightforward, but there are some interesting things to think about when you need to parse attributes, lists, and if you don&rsquo;t want to create new structs all over the place.</p>

<p>For this exercise, let&rsquo;s look at the following XML document:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;person&gt;</span>
</span><span class='line'>  <span class="nt">&lt;name&gt;</span>Luann Van Houten<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>  <span class="nt">&lt;addresses&gt;</span>
</span><span class='line'>      <span class="nt">&lt;address</span> <span class="na">type=</span><span class="s">&quot;secondary&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;street&gt;</span>321 MadeUp Lane<span class="nt">&lt;/street&gt;</span>
</span><span class='line'>          <span class="nt">&lt;city&gt;</span>Shelbyville<span class="nt">&lt;/city&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/address&gt;</span>
</span><span class='line'>      <span class="nt">&lt;address</span> <span class="na">type=</span><span class="s">&quot;primary&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;street&gt;</span>123 Fake St<span class="nt">&lt;/street&gt;</span>
</span><span class='line'>          <span class="nt">&lt;city&gt;</span>Springfield<span class="nt">&lt;/city&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/address&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/addresses&gt;</span>
</span><span class='line'><span class="nt">&lt;/person&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Defining a Data Structure</h3>

<p>The simplest node to parse is going to be <code>&lt;name&gt;</code>. We&rsquo;ll need an object to unmarshal the XML into, which we&rsquo;ll call <code>Person</code>. Every field on <code>Person</code> will be evaluated by the XML encoder to be populated based on the field&rsquo;s name. However, our struct field names and node names don&rsquo;t usually correspond that simply. Because of this, we&rsquo;ll use <code>xml</code> struct tags to identify how to map each node to a go field. Here&rsquo;s an example for <code>&lt;name&gt;</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">type</span> <span class="nx">Person</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`xml:&quot;name&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The next node contains a list of <code>&lt;address&gt;</code> nodes. For an address node, we&rsquo;ll have to create a similar struct with <code>City</code> and <code>Street</code> fields:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">type</span> <span class="nx">Address</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Street</span> <span class="kt">string</span> <span class="s">`xml:&quot;street&quot;`</span>
</span><span class='line'>  <span class="nx">City</span> <span class="kt">string</span>   <span class="s">`xml:&quot;city&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>While parsing each <code>Address</code>, we also want to find the <code>type</code> of address, which can be found as an attribute on the <code>&lt;address&gt;</code> node. By adding <code>attr</code> to our XML struct tag, we can properly parse the <code>type</code> field as well:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">type</span> <span class="nx">Address</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Street</span> <span class="kt">string</span> <span class="s">`xml:&quot;street&quot;`</span>
</span><span class='line'>  <span class="nx">City</span> <span class="kt">string</span>   <span class="s">`xml:&quot;city&quot;`</span>
</span><span class='line'>  <span class="nx">Type</span> <span class="kt">string</span>   <span class="s">`xml:&quot;type,attr&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>A <code>Person</code> has a list of <code>Address</code>es. Since we know that <code>address</code> is a direct descendant, we can use the <code>&gt;</code> keyword to parse each <code>&lt;address&gt;</code> from <code>&lt;addresses&gt;</code> into an embedded struct on our <code>Person</code> struct.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">type</span> <span class="nx">Person</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Name</span> <span class="kt">string</span>         <span class="s">`xml:&quot;name&quot;`</span>
</span><span class='line'>  <span class="nx">Addresses</span> <span class="p">[]</span><span class="nx">Address</span> <span class="s">`xml:&quot;addresses&gt;address&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This code will work to parse the original document, but do we really need to define a formal struct for addresses? If there was only one address, we could put all the fields directly on the <code>Person</code> struct. However, since we&rsquo;re dealing with a list, our best option is to use an anonymous struct:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">type</span> <span class="nx">Person</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Name</span>      <span class="kt">string</span> <span class="s">`xml:&quot;name&quot;`</span>
</span><span class='line'>  <span class="nx">Addresses</span> <span class="p">[]</span><span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">Street</span> <span class="kt">string</span> <span class="s">`xml:&quot;street&quot;`</span>
</span><span class='line'>      <span class="nx">City</span>   <span class="kt">string</span> <span class="s">`xml:&quot;city&quot;`</span>
</span><span class='line'>      <span class="nx">Type</span>   <span class="kt">string</span> <span class="s">`xml:&quot;type,attr&quot;`</span>
</span><span class='line'>  <span class="p">}</span> <span class="s">`xml:&quot;addresses&gt;address&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Binding the Data Structure</h3>

<p>We can use the <a href="https://golang.org/pkg/encoding/xml/">encoding/xml</a> package to decode the given XML. Given that our raw XML document is stored in a <code>[]byte</code> called <code>document</code>, we&rsquo;ll use <code>xml.Unmarshal</code> to bind our data structure to the XML document:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kd">var</span> <span class="nx">luann</span> <span class="nx">Person</span>
</span><span class='line'><span class="nx">xml</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">document</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">luann</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Final Code</h3>

<p>Let&rsquo;s put it all together, including a <code>main</code> function that will use <code>fmt.Println</code> to print the results of binding the data structure to the XML document. <code>Unmarshal</code> could return an error, but we&rsquo;ll ignore it in this case.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="p">(</span>
</span><span class='line'>  <span class="s">&quot;encoding/xml&quot;</span>
</span><span class='line'>  <span class="s">&quot;fmt&quot;</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">personXML</span> <span class="p">=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">`</span>
</span><span class='line'><span class="s">&lt;person&gt;</span>
</span><span class='line'><span class="s">  &lt;name&gt;Luann Van Houten&lt;/name&gt;</span>
</span><span class='line'><span class="s">  &lt;addresses&gt;</span>
</span><span class='line'><span class="s">      &lt;address type=&quot;secondary&quot;&gt;</span>
</span><span class='line'><span class="s">          &lt;street&gt;321 MadeUp Lane&lt;/street&gt;</span>
</span><span class='line'><span class="s">          &lt;city&gt;Shelbyville&lt;/city&gt;</span>
</span><span class='line'><span class="s">      &lt;/address&gt;</span>
</span><span class='line'><span class="s">      &lt;address type=&quot;primary&quot;&gt;</span>
</span><span class='line'><span class="s">          &lt;street&gt;123 Fake St&lt;/street&gt;</span>
</span><span class='line'><span class="s">          &lt;city&gt;Springfield&lt;/city&gt;</span>
</span><span class='line'><span class="s">      &lt;/address&gt;</span>
</span><span class='line'><span class="s">  &lt;/addresses&gt;</span>
</span><span class='line'><span class="s">&lt;/person&gt;`</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="kd">type</span> <span class="nx">Person</span> <span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">Name</span>      <span class="kt">string</span> <span class="s">`xml:&quot;name&quot;`</span>
</span><span class='line'>  <span class="nx">Addresses</span> <span class="p">[]</span><span class="kd">struct</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">Street</span> <span class="kt">string</span> <span class="s">`xml:&quot;street&quot;`</span>
</span><span class='line'>      <span class="nx">City</span>   <span class="kt">string</span> <span class="s">`xml:&quot;city&quot;`</span>
</span><span class='line'>      <span class="nx">Type</span>   <span class="kt">string</span> <span class="s">`xml:&quot;type,attr&quot;`</span>
</span><span class='line'>  <span class="p">}</span> <span class="s">`xml:&quot;addresses&gt;address&quot;`</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">luann</span> <span class="nx">Person</span>
</span><span class='line'>  <span class="nx">xml</span><span class="p">.</span><span class="nx">Unmarshal</span><span class="p">(</span><span class="nx">personXML</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">luann</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">luann</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&rsquo;ve posted this code as <a href="https://gist.github.com/larryprice/204fec2e8d33979f8cac">a gist</a> in <a href="https://play.golang.org/p/qiSoxxb5tp">the go playground</a> so you can see it in action.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/15/responsible-responsive-design/">Responsible Responsive Design</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-15T22:05:57-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:05 pm</span></time>
        
           | <a href="/blog/2015/09/15/responsible-responsive-design/#disqus_thread"
             data-disqus-identifier="https://larry-price.com/blog/2015/09/15/responsible-responsive-design/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>The Gist</h3>

<p>In this modern age of infinite internet-capable devices, web developers have found a &ldquo;silver bullet&rdquo; which we call responsive design. Unfortunately, responsive design is often coupled with large CSS files, delayed element styling, and an overabundance of javascript. Scott Jehl has penned <a href="//abookapart.com/products/responsible-responsive-design">Responsible Responsive Design</a> to help us make the web better. The strategies outlined in this book will make your web pages smarter, faster, and lighter.</p>

<h3>Takeaways</h3>

<p>We are spoiled by 4G, unlimited data, fiber, and the latest smart devices. Most of the world does not have the same luxury as the majority of web designers. We severely limit our userbase when we consider our own lifestyles as the norm. If you want any chance of obtaining a global audience, your site <em>must</em> be able to deal with slow connections, data limits, small screens, and outdated browsers.</p>

<p>The average site still takes 10 seconds to load. Despite generally better network speeds, we have started delivering more CSS, javascript and markup; bigger, higher res images when they aren&rsquo;t always necessary; and long-running javascript to take advantage of the latest and greatest framework. We can and should work to deliver only the content users need.</p>

<p>We can load the top part of the page a user will see before loading the rest of the page by pulling some of our styles into the <code>&lt;head&gt;</code>. In doing this, we can prevent a Flash of Unstyled Content (FOUC) when the user first visits the page. There are tools to do this mentioned in the book, such as <a href="https://github.com/filamentgroup/criticalcss">criticalcss</a>. You can go a step further and load the rest of your CSS at the end of the event queue. Even better: only deliver that experience the first time the user visits that page, after which the browser will have cached the CSS and you can load it through the usual means.</p>

<p>Design your first drafts as naked HTML and CSS. This will be the base experience for a user having a really bad day. Users using old technology, block or fail to load javascript, or experience a bad connection will be able to experience a decent version of your site. Iterate to add a better experience for users who can load javascript. Iterate again to add HTML5 or CSS3 features which may not be available in all browsers. The important aspect is that the app will always degrade gracefully.</p>

<p>Start with the mobile version. If you can design for a small screen with weird gesture inputs, you should be able to translate that to a tablet and desktop machine. Use <code>@media</code> magic to deliver the right content.</p>

<p>Use HTML5 elements when possible. <code>&lt;picture&gt;</code> and <code>&lt;video&gt;</code> can be very efficient in choosing which images or videos to load from the server, preventing the client from downloading the <code>1x</code>, <code>2x</code>, <code>3x</code> versions of your images. Don&rsquo;t forget about <code>&lt;svg&gt;</code> either for handling vector graphics.</p>

<p>Screen readers read <em>everything visible</em>. This can cause a lot of bad things to happen. Using <code>display: none</code> will prevent screen readers from telling the user about your collapsed items (think of all the wasted hamburgers). Elements strategically hidden with <code>z-index</code> are listed by the screen reader as a visible element, potentially misinterpreting your intent. Markup created dynamically could have a drastic effect on that user&rsquo;s experience. We should be diligent with our markup to remain inclusive.</p>

<p>Polyfill, shims, and shivs are some common terms to refer to libraries which fake modern browser functionality into older browsers. <code>html5shiv</code>, <code>selectivizr</code>, and <code>modernizr</code> can be described by these words.</p>

<h3>My Action Items</h3>

<ul>
<li><strong>Start Small.</strong> Although I&rsquo;ve had several projects where I/we start out saying we&rsquo;ll be mobile first, I don&rsquo;t believe this has ever actually happened to me. Next time I start a web project I want to start with mobile and expand.</li>
<li><strong>Degrade Gracefully.</strong> I&rsquo;m notably terrible at this. I don&rsquo;t think I&rsquo;ve ever created a site which will respond well with javascript disabled let alone any HTML5 features which may be missing. I always design my websites with my own devices and connection speeds in mind. For the time being, I will also put this item off until I have the chance to start a project from scratch.</li>
<li><strong>Pay Attention to Accessibility.</strong> Accessibility hasn&rsquo;t been on my mind much when throwing together web sites. If I get some time, I&rsquo;d like to look into adding better screen reader attributes into a live web application like <a href="//ollertapp.com">Ollert</a>.</li>
<li><strong>Page load budgets.</strong> Jehl discusses getting strict about page load time. Keep it low and weigh load time effects heavily when deciding to add new features to a site. When I add new features to pages, I intend to keep this in mind. Look for this to affect something like <a href="//ollertapp.com">Ollert</a> if I ever get around to redesigning the dashboard.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/01/noty-for-easy/">Noty for Easy, Breezy, Beautiful Flash Messages</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-01T18:29:27-04:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2015</span></span> <span class='time'>6:29 pm</span></time>
        
           | <a href="/blog/2015/09/01/noty-for-easy/#disqus_thread"
             data-disqus-identifier="https://larry-price.com/blog/2015/09/01/noty-for-easy/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://ned.im/noty/#/about">Noty</a> is a jQuery plugin for showing flash messages. Noty is easy to use and creates great-looking flash notifications with little customization.</p>

<h4>What&rsquo;s a flash message?</h4>

<p>Flash messages are used to display small bits of information to a user without changing existing page content. If there is an error making an AJAX request, we can display an error flash message to let the user know to try again later. If there is a new shortcut available, we could let the user know with an information flash message.</p>

<h4>Example Time</h4>

<p>You&rsquo;ll need a copy of Noty. As of this time, I haven&rsquo;t seen a CDN hosting the minified version of Noty, so you can download it <a href="https://raw.githubusercontent.com/needim/noty/master/js/noty/packaged/jquery.noty.packaged.min.js">directly from Github</a> and put it somewhere nice. Add a <code>&lt;script&gt;</code> tag to your HTML including the library and let&rsquo;s start using it.</p>

<p>Let&rsquo;s create a single button on our HTML page that, when clicked, will create a new Noty error flash message in the top left.</p>

<iframe style="width: 100%; height: 150px" frameborder="0" seamless="seamless" src="//jsfiddle.net/f14xjf8b/embedded/result,html,js/light/"></iframe>


<p>Cool, right? Break it down:</p>

<ul>
<li>text

<ul>
<li>Obviously, this is the text that will be displayed</li>
</ul>
</li>
<li>layout

<ul>
<li>This allows us to change the position of the flash message. In this case I chose <code>topleft</code>, but other options include <code>top</code>, <code>topCenter</code>, <code>topRight</code>, <code>center</code>, <code>centerLeft</code>, <code>centerRight</code>, <code>bottom</code>, <code>bottomLeft</code>, <code>bottomCenter</code>, and <code>bottomRight</code></li>
</ul>
</li>
<li>timeout

<ul>
<li>How long the notification will stay on the screen (in milliseconds). <code>false</code> for a permanant notification.</li>
</ul>
</li>
<li>type

<ul>
<li>Style of notification to display. Options include <code>error</code>, <code>success</code>, <code>alert</code>, <code>warning</code>, <code>confirmation</code>, and <code>information</code>.</li>
</ul>
</li>
</ul>


<p> Let&rsquo;s add some more so we can see the difference.</p>

<p> <iframe style="width: 100%; height: 150px" frameborder="0" seamless="seamless" src="//jsfiddle.net/f14xjf8b/2/embedded/result,html,js/light/"></iframe></p>

<p> Three notifications, one which stays up for 500ms, one which stays up for 5000ms, and one which stays up indefinitely. I also set the <code>killer</code> property to true on the <code>error</code> notification such that the <code>error</code> notification will close all other notifications. Additionally, I added the <code>closeWith</code> property to the <code>success</code> message to close it by clicking. All of these notifications come up in different locations on the page.</p>

<p> We should also think about theming our notifications. To create a &ldquo;full&rdquo; theme for Noty is a lot of Javascript -  the odds are pretty good you just want to change the color. We can essentially inherit from the default theme and change the colors of the <code>error</code> and <code>information</code> notifictaions in our new theme like this:</p>

<figure class='code'><figcaption><span>testtheme.noty.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">noty</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">testtheme</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">noty</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">);</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">noty</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">testtheme</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;testtheme&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">$</span><span class="p">.</span><span class="nx">noty</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">testtheme</span><span class="p">.</span><span class="nx">style</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">.</span><span class="nx">noty</span><span class="p">.</span><span class="nx">themes</span><span class="p">.</span><span class="nx">defaultTheme</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>    <span class="k">switch</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">case</span> <span class="s1">&#39;error&#39;</span><span class="o">:</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">$bar</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
</span><span class='line'>                <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#DC569F&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">borderColor</span><span class="o">:</span> <span class="s1">&#39;#DC569F&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#F5F5F5&#39;</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>        <span class="k">case</span> <span class="s1">&#39;information&#39;</span><span class="o">:</span>
</span><span class='line'>            <span class="k">this</span><span class="p">.</span><span class="nx">$bar</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
</span><span class='line'>                <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#ABABAB&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">borderColor</span><span class="o">:</span> <span class="s1">&#39;#DC569F&#39;</span><span class="p">,</span>
</span><span class='line'>                <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#F5F5F5&#39;</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>            <span class="k">break</span><span class="p">;</span>
</span><span class='line'>        <span class="k">default</span><span class="o">:</span>
</span><span class='line'>          <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">$message</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">fontWeight</span><span class="o">:</span> <span class="s1">&#39;bold&#39;</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p> We create our new theme <code>testtheme</code> from the <code>defaultTheme</code> prototype and change the <code>name</code> and <code>style</code> properties. Within our custom <code>style</code> function, we go ahead and apply the default theme&rsquo;s style. Then we add a few more adjustments based on the current notification type. Thank goodness it&rsquo;s javascript. Don&rsquo;t forget to include your <code>testtheme.noty.js</code> file in a <code>&lt;script&gt;</code> tag in your HTML. We can apply this theme to any of our notifications by adding the <code>theme</code> property to our call to <code>noty</code> with a value of &lsquo;testtheme&rsquo; (which is the name of the theme we just created). Here&rsquo;s the fiddle showing off our new theme:</p>

<p> <iframe style="width: 100%; height: 150px" frameborder="0" seamless="seamless" src="//jsfiddle.net/f14xjf8b/3/embedded/result,html,js/light/"></iframe></p>

<p> There are many other customization options for the brave, including custom animations and callbacks when the notifications are dismissed. See <a href="http://ned.im/noty/#/about">the full documentation site</a> for more details.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/08/02/extreme-programming-explained/">Extreme Programming Explained</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-08-02T20:14:49-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>8:14 pm</span></time>
        
           | <a href="/blog/2015/08/02/extreme-programming-explained/#disqus_thread"
             data-disqus-identifier="https://larry-price.com/blog/2015/08/02/extreme-programming-explained/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>The Gist</h3>

<p><a href="http://amzn.to/1KKM3Q0"><em>Extreme Programming Explained</em></a> is the <em>de facto</em> book on XP written by Kent Beck. In the world of XP, software development is fun and efficient. Communication is open between all parties, pair programming is mandatory, builds are short, and tests are written before production code. Beck invites the reader to apply bits and pieces of XP to the development process to see incremental improvements, which is a very XP way of implementing XP.</p>

<h3>Takeaways</h3>

<p>XP is about solving people problems. Nearly every challenge we face during software development is caused by dealing with people. Communication is key to fixing most of these problems. On a developer level, pair programming and colocation form closer relationships and cause more conversations to occur.</p>

<p>Do everything in small chunks. Whether you are designing a user experience, architecting a system, or estimating stories you should only address as little as <em>responsible</em> at a time. This means architect a small system first and adapt as a more complex architecture becomes necessary instead of doing it all at once. Create a user interface for the next week&rsquo;s worth of work instead of the whole project. Small chunks means tighter feedback loops and less wasted effort when specs change (and they will change).</p>

<p>Software is built by people. People don&rsquo;t like to be referred to as &ldquo;cogs in a machine.&rdquo; People make mistakes and people create (process) waste. People like to think they are contributing to the success of the company and they like to feel good about what they are creating.</p>

<p>10-minute builds. Beck claims that the perfect build takes 10 minutes; anything more makes people not want to wait for it to finish and anything less isn&rsquo;t enough time to take a coffee break. This concept is not for your constant, at-your-desk 10-second build. When I push my code to the server, it will compile a clean build and run every regression and integration and UX test within 10 minutes. If your regular, 100 times a day desktop build takes more than 10 minutes, you may want to see a shrink.</p>

<p>Teammates should have disagreements but not knife fights (at least not while on the clock). If there are no dissenting opinions about how to implement something you may never find the most efficient answer.</p>

<p>Automated tests are a man&rsquo;s best friend. Tests are a contract describing what the code currently does. Tests can be run by any programmer to verify a working system.</p>

<p>Did I mention test-first development? I&rsquo;ve been through TDD trainings and found testing first difficult to follow strictly. The point of writing your tests first is to prevent any unwanted or undocumented side-effects in the code you just wrote. If you can delete a line of code and the tests still pass, that line of code is either unnecessary or untested.</p>

<p>Taking baby steps is okay. It&rsquo;s unlikely you&rsquo;ll be able to institute all the great changes recommended by XP. Start by figuring out how to get your 15-minute build under 10 minutes. &ldquo;Force&rdquo; your usually unwilling teammate to pair with you when working on a piece of code within said teammate&rsquo;s area of expertise. Take a piece of untested code and wrap it in tests.</p>

<h3>My Action Items</h3>

<ul>
<li>Write more tests. I&rsquo;ve been having a tough time getting tests written in this current project because it&rsquo;s largely UI and initializing a provided library. This week I want to come out net-positive on tests.</li>
<li>Test first. I&rsquo;ve accomplished this on a few occasions, including a recent bug fix I pushed to an open-source library I created. But this is hard. I have a tendency to dive in headfirst when a test could help set the stage for a simpler design.</li>
<li>1-week iterations. I have pushed against 1-week iterations because I often found them to be &ldquo;too short,&rdquo; but I&rsquo;m starting to come around to the idea of getting 1-2 items done per developer (or pair) per iteration. Other benefits include shorter feedback loop and less estimation required. My current project is a team of one, so this action item might have to sit on the backburner for a few months.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/19/muck-with-history-using-the-html5-history-api/">Muck With History Using the HTML5 History API</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-19T11:00:00-04:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:00 am</span></time>
        
           | <a href="/blog/2015/07/19/muck-with-history-using-the-html5-history-api/#disqus_thread"
             data-disqus-identifier="https://larry-price.com/blog/2015/07/19/muck-with-history-using-the-html5-history-api/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Congratulations! You just made a single page web application [SPWA] to do All The Things. What happens when you hit the Back button in the browser? Oops.</p>

<p>The Back button is <a href="http://www.internetnews.com/skerner/2010/07/what-is-the-most-clicked-firef.html">the most used navigation button in the modern browser</a>. SPWA often break the functionality of the Back button. We can fix this using the <a href="http://diveintohtml5.info/history.html">HTML 5 History API</a>.</p>

<p>For this demo, I&rsquo;ll make a simple web page starting with the text &ldquo;Page 1&rdquo; and a &ldquo;Continue&rdquo; button. When I click the &ldquo;Continue&rdquo; button, &ldquo;Welcome&rdquo; will change to &ldquo;Page 1&rdquo;; when I click &ldquo;Page 1&rdquo;, I change to &ldquo;Page 2&rdquo;; ad infinitum. My initial page looks like this:</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;content&quot;</span> <span class="na">style=</span><span class="s">&quot;margin-bottom: 1.5em;&quot;</span><span class="nt">&gt;</span>Welcome<span class="nt">&lt;/span&gt;</span>
</span><span class='line'><span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;continue&quot;</span> <span class="na">onclick=</span><span class="s">&quot;nextPage()&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  Continue
</span><span class='line'><span class="nt">&lt;/button&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">nextPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">===</span> <span class="s2">&quot;Welcome&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">pageNumber</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Page &quot;</span> <span class="o">+</span> <span class="nx">pageNumber</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running this code and clicking &ldquo;Continue&rdquo;, the user has no way to go back. He or she would need to start over from the beginning, which is bad for the user and bad for us too. We can update the browser&rsquo;s history using <code>pushState</code> and <code>popState</code> commands from the History API. For this contrived example, I&rsquo;ll add my <code>pushState</code> call in the <code>nextPage</code> function:</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// ...</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">nextPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">nextPage</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">===</span> <span class="s2">&quot;Welcome&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">nextPage</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;?page=&quot;</span> <span class="o">+</span> <span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now the site will add <code>?page=</code> to the URL whenever we update the page number. This happens when we call <code>history.pushState</code>. In the call to <code>history.pushState</code>, the first argument is some data identifying the state, the second argument is the <code>title</code> of the new page but is currently unused by all the major browsers, and the third argument is the URL of the new state.</p>

<p>In doing this, the Back button has become enabled in the browser. However, it still doesn&rsquo;t work. That&rsquo;s where <code>popState</code> comes in. <code>popState</code> is the other side of the equation which figures out how to change the page when the user hits the Back button. I&rsquo;ll update the call to <code>pushState</code> to include the page number in the <code>state</code> arugment so we can use it.</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">nextPage</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="nx">nextPage</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">===</span> <span class="s2">&quot;Welcome&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">nextPage</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="nx">nextPage</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;?page=&quot;</span> <span class="o">+</span> <span class="nx">nextPage</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">pageNumber</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">pageNumber</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Welcome&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">content</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Page &quot;</span> <span class="o">+</span> <span class="nx">pageNumber</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">onpopstate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">state</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now your history should be <em>mostly</em> working. Hitting Back should take you to the previous page, then hitting Forward should take you to the next page.</p>

<p>There is currently a bug in the version of webkit Safari uses which causes a <code>popstate</code> event to fire on initial page load. We can try to fix this using the <code>replaceState</code> call on page load to set our history&rsquo;s state to the initial value. You can add this event to the bottom of your javascript:</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// ... </span>
</span><span class='line'>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>Of course, I want my web page to be smarter than this. If the user explicitly visits &ldquo;mysweetpage.com?page=3&rdquo; I want the user to be presented with page 3&rsquo;s epic content. Let&rsquo;s modify that <code>onload</code> function to check the current URL state and figure out which page the user has visited:</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">currentPage</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">updatePageContent</span><span class="p">(</span><span class="nx">currentPage</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">(</span><span class="nx">currentPage</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>History changed. Forever. Changing history is a good idea but can easily lead to an even more confusing user scenario. Choose when to change history based on when your application would traditionally need to bring up a new page. Once you have Back working, make sure Forward also acts as expected. Thinking about how you&rsquo;ll integrate the History API into your web application can help you write more sensible, modular code.</p>

<p>If you&rsquo;re looking for the full code that we created above, check out <a href="https://gist.github.com/larryprice/b06dd00c3e7f63ae7954">this gist</a>.</p>

<p>&lt;3 HTML5</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/9">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/7">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <span class="social-media-bar">
    <a href="https://github.com/larryprice" title="Github" alt="github profile"><img src="/images/icon_github.png" class="social-media-icon" /></a>
    <!-- <a href="https://launchpad.net/~larryprice" title="Launchpad" alt="launchpad profile"><img src="/images/icon_lp.png" class="social-media-icon" /></a> -->
    <a href="https://www.patreon.com/larryprice" title="Patreon" alt="patreon profile"><img src="/images/icon_patreon.png" class="social-media-icon" /></a>
    <a href="https://twitter.com/larryrprice" title="Twitter" alt="Twitter profile"><img src="/images/icon_twitter.png" class="social-media-icon" /></a>
    <a href="https://www.linkedin.com/pub/larry-price/3a/630/47b" title="LinkedIn" alt="LinkedIn profile"><img src="/images/icon_linkedin.png" class="social-media-icon" /></a>
    <a href="mailto:larry@larry-price.com" title="Email" alt="email me"><img src="/images/icon_email.png" class="social-media-icon" /></a>
  </span>
</section>
<section>
  <h1>void* Larry</h1>
  <p>I'm a codeslinger debugging from the mean streets of Champaign-Urbana, IL. Welcome to my blog, where I'll tell the tales of wondrous things I discover in the digital jungle.</p>
</section>
<section>
  <h1>Patreon</h1>
  <p>Like what I'm doing? <b><a href="https://www.patreon.com/larryprice">Fund me on Patreon</a></b> so I can keep doing it!</p>
</section>
<section>
  <h1>Go for Web Development</h1>
  <p><strong><a href="https://www.packtpub.com/web-development/go-web-development-video" target="blank">Go for Web Development</a></strong> is an online video series designed by me where you'll follow along to build a personal library app in Go. You'll start with a blank slate but quickly learn to take advantage of popular libraries such as gorilla/mux, negroni, gorp, ace, and bcrypt.</p>
</section>
<section>
  <h1>FOSDEM 2017</h1>
  <p>In 2017, I had the opportunity to give a short talk at FOSDEM in Brussels. I even <strong><a href="https://www.youtube.com/watch?v=FX1fSTOU8Ao&t=1152s" target="blank">recorded an at-home experience</a></strong> with higher quality audio and slides than the livestream.</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/02/09/getting-started-with-react-hooks/">Getting Started With React Hooks</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/27/notes-from-all-things-open-2018/">Notes From All Things Open 2018</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/06/27/how-to-use-getderivedstatefromprops-in-react-16-dot-3-plus/">How to Use getDerivedStateFromProps in React 16.3+</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/04/26/quick-start-to-vendor-go-dependencies-with-govendor/">Quick Start to Vendor Go Dependencies With Govendor</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/04/25/redirecting-to-your-main-site-with-heroku/">Redirecting to Your Main Site With Heroku</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/ads' style='font-size: 103.63636363636364%'>ads</a> <a href='/blog/categories/agile' style='font-size: 105.45454545454545%'>agile</a> <a href='/blog/categories/api' style='font-size: 101.81818181818181%'>api</a> <a href='/blog/categories/c-plus-plus' style='font-size: 107.27272727272727%'>c++</a> <a href='/blog/categories/capybara' style='font-size: 105.45454545454545%'>capybara</a> <a href='/blog/categories/css' style='font-size: 103.63636363636364%'>css</a> <a href='/blog/categories/cucumber' style='font-size: 107.27272727272727%'>cucumber</a> <a href='/blog/categories/database' style='font-size: 112.72727272727272%'>database</a> <a href='/blog/categories/dbus' style='font-size: 105.45454545454545%'>dbus</a> <a href='/blog/categories/docker' style='font-size: 107.27272727272727%'>docker</a> <a href='/blog/categories/foreman' style='font-size: 101.81818181818181%'>foreman</a> <a href='/blog/categories/foss' style='font-size: 103.63636363636364%'>foss</a> <a href='/blog/categories/git' style='font-size: 101.81818181818181%'>git</a> <a href='/blog/categories/gmock' style='font-size: 101.81818181818181%'>gmock</a> <a href='/blog/categories/go' style='font-size: 103.63636363636364%'>go</a> <a href='/blog/categories/golang' style='font-size: 118.18181818181819%'>golang</a> <a href='/blog/categories/gtest' style='font-size: 101.81818181818181%'>gtest</a> <a href='/blog/categories/hacks' style='font-size: 101.81818181818181%'>hacks</a> <a href='/blog/categories/haml' style='font-size: 101.81818181818181%'>haml</a> <a href='/blog/categories/heroku' style='font-size: 107.27272727272727%'>heroku</a> <a href='/blog/categories/html' style='font-size: 103.63636363636364%'>html</a> <a href='/blog/categories/html5' style='font-size: 101.81818181818181%'>html5</a> <a href='/blog/categories/internet' style='font-size: 101.81818181818181%'>internet</a> <a href='/blog/categories/javascript' style='font-size: 130.9090909090909%'>javascript</a> <a href='/blog/categories/linux' style='font-size: 110.9090909090909%'>linux</a> <a href='/blog/categories/mongo' style='font-size: 101.81818181818181%'>mongo</a> <a href='/blog/categories/mongodb' style='font-size: 105.45454545454545%'>mongodb</a> <a href='/blog/categories/mongoid' style='font-size: 105.45454545454545%'>mongoid</a> <a href='/blog/categories/mongolab' style='font-size: 101.81818181818181%'>mongolab</a> <a href='/blog/categories/mongoose' style='font-size: 101.81818181818181%'>mongoose</a> <a href='/blog/categories/mvc' style='font-size: 101.81818181818181%'>mvc</a> <a href='/blog/categories/nodejs' style='font-size: 109.0909090909091%'>nodejs</a> <a href='/blog/categories/non-technical' style='font-size: 160.0%'>non-technical</a> <a href='/blog/categories/nosql' style='font-size: 101.81818181818181%'>nosql</a> <a href='/blog/categories/nvm' style='font-size: 101.81818181818181%'>nvm</a> <a href='/blog/categories/octopress' style='font-size: 101.81818181818181%'>octopress</a> <a href='/blog/categories/ollert' style='font-size: 125.45454545454545%'>ollert</a> <a href='/blog/categories/openshift' style='font-size: 101.81818181818181%'>openshift</a> <a href='/blog/categories/php' style='font-size: 101.81818181818181%'>php</a> <a href='/blog/categories/pokephile' style='font-size: 105.45454545454545%'>pokephile</a> <a href='/blog/categories/pony' style='font-size: 101.81818181818181%'>pony</a> <a href='/blog/categories/python' style='font-size: 107.27272727272727%'>python</a> <a href='/blog/categories/qt' style='font-size: 101.81818181818181%'>qt</a> <a href='/blog/categories/rails' style='font-size: 101.81818181818181%'>rails</a> <a href='/blog/categories/react' style='font-size: 101.81818181818181%'>react</a> <a href='/blog/categories/reactjs' style='font-size: 105.45454545454545%'>reactjs</a> <a href='/blog/categories/remote' style='font-size: 107.27272727272727%'>remote</a> <a href='/blog/categories/retro' style='font-size: 112.72727272727272%'>retro</a> <a href='/blog/categories/rspec' style='font-size: 101.81818181818181%'>rspec</a> <a href='/blog/categories/ruby' style='font-size: 130.9090909090909%'>ruby</a> <a href='/blog/categories/rvm' style='font-size: 105.45454545454545%'>rvm</a> <a href='/blog/categories/sass' style='font-size: 101.81818181818181%'>sass</a> <a href='/blog/categories/satire' style='font-size: 101.81818181818181%'>satire</a> <a href='/blog/categories/sendgrid' style='font-size: 101.81818181818181%'>sendgrid</a> <a href='/blog/categories/sep-blog-battle' style='font-size: 114.54545454545455%'>sep-blog-battle</a> <a href='/blog/categories/sequel' style='font-size: 101.81818181818181%'>sequel</a> <a href='/blog/categories/sinatra' style='font-size: 116.36363636363636%'>sinatra</a> <a href='/blog/categories/snappy' style='font-size: 105.45454545454545%'>snappy</a> <a href='/blog/categories/testing' style='font-size: 114.54545454545455%'>testing</a> <a href='/blog/categories/trello' style='font-size: 114.54545454545455%'>trello</a> <a href='/blog/categories/twitter-bootstrap' style='font-size: 103.63636363636364%'>twitter-bootstrap</a> <a href='/blog/categories/ubuntu' style='font-size: 118.18181818181819%'>ubuntu</a> <a href='/blog/categories/unity' style='font-size: 101.81818181818181%'>unity</a> <a href='/blog/categories/upstart' style='font-size: 101.81818181818181%'>upstart</a> <a href='/blog/categories/web' style='font-size: 141.8181818181818%'>web</a> <a href='/blog/categories/write-ups' style='font-size: 143.63636363636363%'>write-ups</a> <a href='/blog/categories/xml' style='font-size: 101.81818181818181%'>xml</a> </span>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/larryprice">@larryprice</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'larryprice',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <style>
    .sidebar-ad { width: 280px; height: 280px; }}
    @media(min-width: 375px) { .sidebar-ad { width: 350px; height: 90px; } }
    @media(min-width: 475px) { .sidebar-ad { width: 450px; height: 90px; } }
    @media(min-width: 575px) { .sidebar-ad { width: 550px; height: 90px; } }
    @media(min-width: 675px) { .sidebar-ad { width: 650px; height: 90px; } }
    @media(min-width: 750px) { .sidebar-ad { width: 200px; height: 200px; } }
    @media(min-width: 768px) { .sidebar-ad { width: 210px; height: 210px; } }
    @media(min-width: 1280px) { .sidebar-ad { width: 260px; height: 260px; } }
  </style>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- Sidebar Ad -->
    <ins class="adsbygoogle sidebar-ad"
         style="display:inline-block"
         data-ad-client="ca-pub-6961096698495477"
         data-ad-slot="8892886941"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  <center>
	  Copyright &copy; 2019 - Larry Price -
	  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span><br/>
	  Note: Views and opinions expressed belong solely to the author and do not represent the views of the any other person or company.
	</center>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'larryprice';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
